<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Test Thanh ToÃ¡n Pi</title>
    <script src="https://sdk.minepi.com/pi-sdk.js"></script>
  </head>
  <body style="text-align:center; font-family:sans-serif; padding:30px; background:#f9f9ff;">
    <h2>ğŸµ Pi Payment Test â€“ Dá»± Ã¡n PiChordify ğŸµ</h2>
    <button onclick="payWithPi()" style="font-size:18px; padding:10px 20px;">ğŸ’ Thanh toÃ¡n 0.3 Pi</button>

    <script>
      Pi.init({ version: "2.0", sandbox: false });

      function payWithPi() {
        const scopes = ['username', 'payments'];
        const onIncomplete = (payment) => {
          console.log("Incomplete payment:", payment);
        };

        Pi.authenticate(scopes, onIncomplete)
          .then(function(auth) {
            console.log("Authenticated as:", auth.user.username);

            const paymentData = {
              amount: 0.3,
              memo: "Thanh toÃ¡n test cho PiChordify Kingdom",
              metadata: { purpose: "test_payment_step11" }
            };

            Pi.createPayment(paymentData, {
              onReadyForServerApproval: function(paymentId) {
                console.log("âœ… Server approval needed for:", paymentId);
              },
              onReadyForServerCompletion: function(paymentId, txid) {
                console.log("âœ… Payment complete:", paymentId, txid);
                alert("ğŸ‰ Thanh toÃ¡n thÃ nh cÃ´ng! Má»¥c 11 Ä‘Ã£ xong.");
              },
              onCancel: function(paymentId) {
                console.warn("âŒ ÄÃ£ huá»·:", paymentId);
                alert("Báº¡n Ä‘Ã£ huá»· thanh toÃ¡n.");
              },
              onError: function(error, payment) {
                console.error("âŒ Lá»—i thanh toÃ¡n:", error);
                alert("CÃ³ lá»—i xáº£y ra, thá»­ láº¡i sau.");
              }
            });

          })
          .catch(function(error) {
            console.error("ÄÄƒng nháº­p tháº¥t báº¡i:", error);
            alert("KhÃ´ng thá»ƒ Ä‘Äƒng nháº­p vá»›i Pi.");
          });
      }
    </script>
  </body>
</html>
