<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Tran682025 Pi App</title>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
  <script>
    Pi.init({ version: "2.0", sandbox: true });

    let paymentData = {
      amount: 0.01,
      memo: "Thanh toÃ¡n thá»­ nghiá»‡m Pi",
      metadata: { type: "test-payment" }
    };

    let paymentFn = null;

    function login() {
      const scopes = ['username', 'payments'];
      const onIncompletePaymentFound = (payment) => {
        console.log('Incomplete payment found:', payment);
        paymentFn = () => Pi.createPayment(payment);
      };

      Pi.authenticate(scopes, onIncompletePaymentFound)
        .then(function(auth) {
          console.log('Authenticated!', auth);
          alert("Xin chÃ o, " + auth.user.username);
          paymentFn = () => {
            Pi.createPayment(paymentData, {
              onReadyForServerApproval: (paymentId) => {
                console.log('Ready for server approval:', paymentId);
              },
              onReadyForServerCompletion: (paymentId, txid) => {
                console.log('Ready for server completion:', paymentId, txid);
              },
              onCancel: (paymentId) => {
                console.log('Payment cancelled:', paymentId);
              },
              onError: (error, payment) => {
                console.error('Payment error:', error, payment);
              }
            });
          };
        })
        .catch(function(error) {
          console.error('Login failed:', error);
          alert("ÄÄƒng nháº­p tháº¥t báº¡i: " + error);
        });
    }

    function pay() {
      if (paymentFn) {
        paymentFn();
      } else {
        alert("Vui lÃ²ng Ä‘Äƒng nháº­p trÆ°á»›c khi thanh toÃ¡n.");
      }
    }
  </script>
</head>
<body>
  <h1>Welcome to Tran682025 Pi App</h1>
  <button onclick="login()">ğŸ” ÄÄƒng nháº­p Pi</button>
  <button onclick="pay()">ğŸ’° Thanh toÃ¡n 0.01 Pi</button>
</body>
</html>
